Source code redesigned for versions 2.3.4 and 2.26.5
